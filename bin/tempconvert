#!/usr/bin/env bash
# modified script from https://github.com/BreadOnPenguins/scripts/

menu='wofi --show dmenu'
command -v bc >/dev/null || { notify-send "Error: bc not found"; exit 1; }

f_to_c () { \
    fahrenheit="$($menu -L 1 -p 'fahrenheit: ')"
    [ -z "$fahrenheit" ] && exit
    [[ "$fahrenheit" =~ ^-?[0-9]+(\.[0-9]+)?$ ]] || { notify-send "Error: Not a valid number"; exit 1; }
    celsius=$(bc <<< "scale=2; ($fahrenheit - 32) * 5/9")
    notify-send "$fahrenheit°F = $celsius°C"
}


c_to_f() { \
    celsius="$($menu -L 1 -p 'celsius: ')"
    [ -z "$celsius" ] && exit
    [[ "$celsius" =~ ^-?[0-9]+(\.[0-9]+)?$ ]] || { notify-send "Error: Not a valid number"; exit 1; }
    fahrenheit=$(bc <<< "scale=2; ($celsius * 9/5) + 32")
    notify-send "$celsius°C = $fahrenheit°F"
}


choice() { \
  choose=$(printf "Fahrenheit în Celsius\\nCelsius în Fahrenheit" | $menu -L 3 -i -p "Conversie: ")
  case "$choose" in
    *Celsius) f_to_c ;;
    *Fahrenheit) c_to_f ;;
    *) exit;;
  esac
}

choice
